
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Configure the GMN Asynchronous Processes &mdash; v1.0.0</title>
    
    <link rel="stylesheet" href="_static/dataone.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="top" title="v1.0.0" href="index.html" />
    <link rel="up" title="GMN setup overview" href="setup.html" />
    <link rel="next" title="Final configuration and startup" href="setup-final.html" />
    <link rel="prev" title="Select the DataONE Tier" href="setup-tier.html" />
   
  
  <link media="only screen and (max-device-width: 480px)" href="_static/small_dataone.css" type= "text/css" rel="stylesheet" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="setup-final.html" title="Final configuration and startup"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="setup-tier.html" title="Select the DataONE Tier"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html"></a> &raquo;</li>
          <li><a href="setup.html" accesskey="U">GMN setup overview</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="configure-the-gmn-asynchronous-processes">
<h1>Configure the GMN Asynchronous Processes<a class="headerlink" href="#configure-the-gmn-asynchronous-processes" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is only necessary to perform this step if GMN has been configured
to run as a Tier 4 node. See <a class="reference internal" href="setup-tier.html"><em>Select the DataONE Tier</em></a>.</p>
</div>
<p>GMN stores replication requests, submitted by CNs, in a queue. An asynchronous
replication process, launched at regular intervals by <a class="reference internal" href="glossary.html#term-cron"><em class="xref std std-term">cron</em></a>, connects to
GMN and process any queued replication requests.</p>
<p>This describes how to set the asynchronous processes up to run from their
default location. However, the processes can run from any location, including a
different server. Running the asynchronous processes on a different server <em>may</em>
be beneficial if the GMN server is very busy.</p>
<p>The asynchronous processes connect to CNs and other MNs on behalf of this GMN
instance and thus need access to the DataONE client side certificate (issued to
this GMN instance by DataONE in the registration process). As this GMN instance
already has been set up to accept connections from other DataONE signed
certificates, the async processes only need to be set up with a single
certificate.</p>
<div class="section" id="enable-access-to-internal-rest-service">
<h2>Enable access to internal REST service<a class="headerlink" href="#enable-access-to-internal-rest-service" title="Permalink to this headline">¶</a></h2>
<p>The asynchronous processes use REST interfaces internal to GMN to access and
update information they require in order to perform their tasks. Only the client
side certificate issued to this instance of GMN by DataONE should enable
connection to GMNs internal interfaces. Because of this, access to the internal
interfaces is protected by a whitelist of subjects.</p>
<blockquote>
<div><p>Configure GMN to allow the Subject DN in the certificate used by the
asynchronous processes to access the GMN internal REST APIs.</p>
<p>Edit: <tt class="docutils literal"><span class="pre">/var/local/dataone/gmn/lib/python2.6/site-packages/service/settings_site.py</span></tt></p>
<ul class="simple">
<li>Add the DataONE compliant serialization of the DN to GMN_INTERNAL_SUBJECTS.
E.g., <cite>CN=MyMemberNode,O=DataONE,C=US,DC=dataone,DC=org</cite></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="replication">
<h2>Replication<a class="headerlink" href="#replication" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Create a cron entry for the replication process:</p>
<div class="highlight-none"><div class="highlight"><pre>$ su gmn
$ crontab -e
</pre></div>
</div>
<p>Add:</p>
<div class="highlight-none"><div class="highlight"><pre>* * * * * cd /var/local/dataone/gmn/lib/python2.6/site-packages/service/async &amp;&amp; /var/local/dataone/gmn/bin/python ./process_replication_queue.py &gt;&gt;process_replication_queue.log 2&gt;&amp;1
</pre></div>
</div>
<p>This sets the replication process to run every minute. To alter the schedule,
consult the crontab manual:</p>
<div class="highlight-none"><div class="highlight"><pre>$ man 5 crontab
</pre></div>
</div>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/dataone_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Configure the GMN Asynchronous Processes</a><ul>
<li><a class="reference internal" href="#enable-access-to-internal-rest-service">Enable access to internal REST service</a></li>
<li><a class="reference internal" href="#replication">Replication</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation Overview</a><ul>
  <li><a href="setup.html">GMN setup overview</a><ul>
      <li>Previous: <a href="setup-tier.html" title="previous chapter">Select the DataONE Tier</a></li>
      <li>Next: <a href="setup-final.html" title="next chapter">Final configuration and startup</a></li>
  </ul></li>
  </ul></li>
</ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer">
      &copy; Copyright <a href="http:/www.dataone.org">2010-2012 Participating institutions in DataONE</a>.
        [ <a href="_sources/setup-async.txt"
               rel="nofollow">Page Source</a> | 
          <a href='https://redmine.dataone.org/projects/d1/repository/changes/documents/Projects/cicore/architecture/api-documentation/source/setup-async.txt'
            rel="nofollow">Revision History</a> ]&nbsp;&nbsp;
    </div>
    <!--
    <hr />
     <div id="HCB_comment_box"><a href="http://www.htmlcommentbox.com">HTML Comment Box</a> is loading comments...</div>
     <link rel="stylesheet" type="text/css" href="_static/skin.css" />
     <script type="text/javascript" language="javascript" id="hcb"> 
     /*<! -*/ 
     (function()
     {s=document.createElement("script");
     s.setAttribute("type","text/javascript");
     s.setAttribute("src", "http://www.htmlcommentbox.com/jread?page="+escape((typeof hcb_user !== "undefined" && hcb_user.PAGE)||(""+window.location)).replace("+","%2B")+"&mod=%241%24wq1rdBcg%24Gg8J5iYSHJWwAJtlYu/yU."+"&opts=21407&num=10");
     if (typeof s!="undefined") document.getElementsByTagName("head")[0].appendChild(s);})();
      /* ->*/ 
     </script>
   -->
  </body>
</html>