
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Register the MN &mdash; v1.0.0</title>
    
    <link rel="stylesheet" href="_static/dataone.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="top" title="v1.0.0" href="index.html" />
    <link rel="up" title="Setup steps" href="setup-steps.html" />
    <link rel="next" title="GMN Asynchronous Processes" href="setup-async.html" />
    <link rel="prev" title="DataONE Generic Member Node" href="setup-d1-gmn.html" />
   
  
  <link media="only screen and (max-device-width: 480px)" href="_static/small_dataone.css" type= "text/css" rel="stylesheet" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="setup-async.html" title="GMN Asynchronous Processes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="setup-d1-gmn.html" title="DataONE Generic Member Node"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html"></a> &raquo;</li>
          <li><a href="setup.html" >Setup</a> &raquo;</li>
          <li><a href="setup-steps.html" accesskey="U">Setup steps</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="register-the-mn">
<h1>Register the MN<a class="headerlink" href="#register-the-mn" title="Permalink to this headline">¶</a></h1>
<p>Registering the MN is a two step process. First, a client side certificate is
obtained for the MN. The MN will use the client side certificate to identify
itself in all calls to DataONE nodes.</p>
<p>Second, an XML document, called a Node document is submitted to a DataONE
CN. The document contains the information required by the DataONE infrastructure
to interact with the MN.</p>
<div class="section" id="selecting-a-dataone-environment">
<h2>Selecting a DataONE environment<a class="headerlink" href="#selecting-a-dataone-environment" title="Permalink to this headline">¶</a></h2>
<p>In addition the the default production environment, DataONE maintains several
separate environments for use when developing and testing DataONE components.
There are no connections between the environments. For instance, certificates,
DataONE identities and science objects are exclusive to the environment in
which they were created.</p>
<p>The environments are:</p>
<ul class="simple">
<li><strong>Development</strong>: Unstable components under active development.</li>
<li><strong>Staging</strong>: Testing of release candiates.</li>
<li><strong>Sandbox</strong>: Like Production, but open to test instances of MNs. May contain
both test and real science objects.</li>
<li><strong>Production</strong>: Stable production environment for use by the public.</li>
</ul>
<p>You may chose to register this MN deployment in the Production environment.
However, if this deployment is more experimental in nature, for instance, if the
purpose is to learn more about the DataONE infrastructure or if this MN will
be populated with objects that may not be of production quality, then one of
the other environments should be selected.</p>
<p>Depending on which environment you select, substitute <strong>&lt;env&gt;</strong> in the
instructions below with one of:</p>
<div class="highlight-python"><pre>https://cn-dev.dataone.org
https://cn-stage.dataone.org
https://cn-sandbox.dataone.org
https://cn.dataone.org</pre>
</div>
</div>
<div class="section" id="create-a-dataone-identify">
<h2>Create a DataONE identify<a class="headerlink" href="#create-a-dataone-identify" title="Permalink to this headline">¶</a></h2>
<p>Use the DataONE Identity Manager to create a DataONE identity for the
administrator / contact for the new MN.</p>
<p>Visit <strong>&lt;env&gt;</strong>/portal/ and follow the instructions.</p>
</div>
<div class="section" id="obtaining-a-client-side-certificate">
<h2>Obtaining a client side certificate<a class="headerlink" href="#obtaining-a-client-side-certificate" title="Permalink to this headline">¶</a></h2>
<p>To obtain a client side certificate, generate a certificate request and email
it to DataONE. DataONE will return a signed certificate by email.</p>
<blockquote>
<div><p>Create the private key for the certificate:</p>
<div class="highlight-python"><pre>$ openssl genrsa -des3 -out my_member_node.key 4096</pre>
</div>
<p>Create the certificate request:</p>
<div class="highlight-python"><pre>$ openssl req -new -key my_member_node.key -out my_member_node.csr</pre>
</div>
<p>You will be prompted for information that, combined, will become the
Distinguished Name (DN) for this MN. Please supply <em>Country Name</em>, <em>State or
Province Name</em>, <em>Locality Name</em>, <em>Organization Name</em> and <em>Common Name</em>. Leave
the remaining fields blank. For fields with a default, type a period (&#8221;.&#8221;).
For fields without a default, press Enter.</p>
</div></blockquote>
<p>Note: Anyone who has the private key can impersonate your Node in the DataONE
infrastructure. Keep the private key safe. If your private key becomes
compromised, please inform DataONE so that the certificate can be revoked.</p>
<blockquote>
<div>Email the my_member_node.csr file to DataONE at <a class="reference external" href="mailto:cert-requests&#37;&#52;&#48;dataone&#46;org">cert-requests<span>&#64;</span>dataone<span>&#46;</span>org</a>. In
the email, include for which environment you would like the certificate to be
signed. The certificate will only be trusted in that environment.</div></blockquote>
</div>
<div class="section" id="registering-the-mn-with-dataone">
<h2>Registering the MN with DataONE<a class="headerlink" href="#registering-the-mn-with-dataone" title="Permalink to this headline">¶</a></h2>
<p>This step can only be performed after the signed client side certificate has
been received from DataONE. See <a class="reference internal" href="#obtaining-a-client-side-certificate">Obtaining a client side certificate</a>.</p>
<p>Each DataONE Node has an XML document associated with it that describes the
various aspects of the Node, such as its URL, the services it supports and who
maintains and runs the Node. For now, it is necessary to manually edit this
file with information specific to this MN. A template is provided to simplify
this process.</p>
<blockquote>
<div><p>Customize the Node document.</p>
<p>Copy the Node XML template:</p>
<div class="highlight-python"><pre>$ cd /var/local/dataone/mn_generic/service/stores/static/
$ cp nodeRegistry_template.xml nodeRegistry.xml</pre>
</div>
<p>Edit the document:</p>
<blockquote>
<div><p>Edit
<tt class="docutils literal"><span class="pre">/var/local/dataone/mn_generic/service/stores/static/nodeRegistry.xml</span></tt>.</p>
<p>Replace the upper case texts with information specific to your MN. The parts
of the document that do not contain upper case text should remain unchanged.</p>
<ul class="simple">
<li><strong>identifier</strong>: A unique identifier for the node. This may initially be
the same as the baseURL, however this value should not change for future
implementations of the same node, whereas the baseURL may change in the
future.</li>
<li><strong>name</strong>: A human readable name of the Node.</li>
<li><strong>description</strong>: Description of content maintained by this node and any
other free style notes.</li>
<li><strong>baseURL</strong>: The URL at which the Node is available.</li>
<li><strong>contactSubject</strong>: The subject field exactly as it is displayed in the
DataONE Identity Manager. See <a class="reference internal" href="#create-a-dataone-identify">Create a DataONE identify</a>.</li>
</ul>
<p>For more information about the Node document, refer to
<a class="reference external" href="http://mule1.dataone.org/ArchitectureDocs-current/apis/Types.html#Types.Node">http://mule1.dataone.org/ArchitectureDocs-current/apis/Types.html#Types.Node</a></p>
</div></blockquote>
</div></blockquote>
<p>To register the new MN with DataONE, the Node XML document is submitted to
DataONE via a CN REST API. The connection to DataONE is made over TLS/SSL,
with the client side certificate that DataONE issued.</p>
<p>A command line tool is provided for submitting the registration.</p>
<blockquote>
<div><p>Register the MN with DataONE:</p>
<div class="highlight-python"><pre>$ cd /var/local/dataone/mn_generic/tools
$ python register.py \
  --cert-path &lt;path to the DataONE issued MN client side certificate&gt; \
  --cert-key &lt;path to the DataONE issued MN client side certificate key&gt; \
  --dataone-url &lt;dev&gt;/cn
  ../service/stores/static/nodeRegistry.xml</pre>
</div>
</div></blockquote>
<p>A new MN must be approved by DataONE. The person that is registered as
<em>contactSubject</em> in the Node document, will be contacted by email with the
outcome of the approval process. After the Node has been approved, CNs will
start processing the information on the node.</p>
</div>
<div class="section" id="revisit-the-gmn-configuration">
<h2>Revisit the GMN configuration<a class="headerlink" href="#revisit-the-gmn-configuration" title="Permalink to this headline">¶</a></h2>
<p>In the <a class="reference internal" href="setup-d1-gmn.html"><em>DataONE Generic Member Node</em></a> step, setting the NODE_IDENTIFIER value was deferred
because it must be set up to match the value configured in this step.</p>
<blockquote>
<div><p>Edit: <tt class="docutils literal"><span class="pre">/var/local/dataone/mn_generic/service/settings_site.py</span></tt></p>
<ul class="simple">
<li>Set NODE_IDENTIFIER to match the value specified in the identifier field
in the Node XML document.</li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/dataone_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Register the MN</a><ul>
<li><a class="reference internal" href="#selecting-a-dataone-environment">Selecting a DataONE environment</a></li>
<li><a class="reference internal" href="#create-a-dataone-identify">Create a DataONE identify</a></li>
<li><a class="reference internal" href="#obtaining-a-client-side-certificate">Obtaining a client side certificate</a></li>
<li><a class="reference internal" href="#registering-the-mn-with-dataone">Registering the MN with DataONE</a></li>
<li><a class="reference internal" href="#revisit-the-gmn-configuration">Revisit the GMN configuration</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation Overview</a><ul>
  <li><a href="setup.html">Setup</a><ul>
  <li><a href="setup-steps.html">Setup steps</a><ul>
      <li>Previous: <a href="setup-d1-gmn.html" title="previous chapter">DataONE Generic Member Node</a></li>
      <li>Next: <a href="setup-async.html" title="next chapter">GMN Asynchronous Processes</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer">
      &copy; Copyright <a href="http:/www.dataone.org">2010,2011 Participating institutions in DataONE</a>.
        [ <a href="_sources/setup-registration.txt"
               rel="nofollow">Page Source</a> | 
          <a href='https://redmine.dataone.org/projects/d1/repository/changes/documents/Projects/cicore/architecture/api-documentation/source/setup-registration.txt'
            rel="nofollow">Revision History</a> ]&nbsp;&nbsp;
    </div>
    <!--
    <hr />
     <div id="HCB_comment_box"><a href="http://www.htmlcommentbox.com">HTML Comment Box</a> is loading comments...</div>
     <link rel="stylesheet" type="text/css" href="_static/skin.css" />
     <script type="text/javascript" language="javascript" id="hcb"> 
     /*<! -*/ 
     (function()
     {s=document.createElement("script");
     s.setAttribute("type","text/javascript");
     s.setAttribute("src", "http://www.htmlcommentbox.com/jread?page="+escape((typeof hcb_user !== "undefined" && hcb_user.PAGE)||(""+window.location)).replace("+","%2B")+"&mod=%241%24wq1rdBcg%24Gg8J5iYSHJWwAJtlYu/yU."+"&opts=21407&num=10");
     if (typeof s!="undefined") document.getElementsByTagName("head")[0].appendChild(s);})();
      /* ->*/ 
     </script>
   -->
  </body>
</html>