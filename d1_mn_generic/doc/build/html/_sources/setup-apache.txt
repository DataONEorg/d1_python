Install and configure Apache
============================

Setting up Apache.

  Install Apache2 packages::

    $ sudo apt-get --yes install apache2 apache2-threaded-dev

  Install the GMN virtual host file and custom apache2.conf file::

    $ cd /var/local/dataone/gmn/lib/python2.6/site-packages/deployment
    $ sudo cp apache2.conf ports.conf httpd /etc/apache2/
    $ sudo cp gmn-ssl /etc/apache2/sites-available/
    $ sudo cp forward_http_to_https /etc/apache2/conf.d/


The :term:`mod_ssl` module handles TLS/SSL connections for GMN and validates
client side certificates. It is included in the apache2-common package.

The :term:`mod_wsgi` module enables Apache to communicate with Django and GMN.

  Install and enable required modules::

    $ sudo apt-get --yes install libapache2-mod-wsgi apache2.2-common
    $ sudo a2enmod wsgi ssl rewrite

  Enable the GMN virtual host::

    $ sudo a2ensite gmn-ssl

  * If an intermediate certificate file or certificate chain file was installed
    in :doc:`setup-authn-server`, edit ``/etc/apache2/sites-available/gmn-ssl``
    and uncomment the line for ``SSLCertificateChainFile``.

\

  * If a key without password was NOT created in :doc:`setup-authn-server`, edit
    ``/etc/apache2/sites-available/gmn-ssl`` and substitute
    ``server.nopassword.key`` with ``server.key``.
