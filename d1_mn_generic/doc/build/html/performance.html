

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Performance &mdash; DataONE Generic Member Node 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="DataONE Generic Member Node 1.0.0 documentation" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="index.html">DataONE Generic Member Node 1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/performance.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="performance">
<h1>Performance<a class="headerlink" href="#performance" title="Permalink to this headline">Â¶</a></h1>
<p>&lt;scratch&gt;</p>
<p>Optimizing GMN for performance.</p>
<p>The MNRead.listObjects() call does ordered, sliced and filtered selects from the
object table. The object table should be clustered on mtime. With PostgreSQL,
this can be done with the CLUSTER command:</p>
<div class="highlight-python"><pre>cluster mn_object using mtime;</pre>
</div>
<p>PostgreSQL will not automatically keep the table clustered. Instead, the
table must be clustered whenever sufficient changes have been accumulated.</p>
<p>To keep the table clustered for longer, adjust the fill factor.</p>
<p>&#8211;</p>
<p>MNCore.getLogRecords() can be optimized in the same ways as MNRead.listObjects().</p>
<p>The mn_event_log should be clustered on date_logged:</p>
<div class="highlight-python"><pre>cluster mn_event_log using date_logged</pre>
</div>
<p>&#8211;</p>
<p>cluster mn_object using mn_object_mtime;</p>
<p>&#8211;</p>
<p>analyze</p>
<p>vacuum</p>
<p>~~</p>
<p>The bad is that since there is no additional overhead aside from the usual index
key creation during table inserts and updates, you need to schedule reclustering
to maintain your fine order and the clustering causes a table lock. The annoying
locking hopefully will be improved in later versions. Scheduling a cluster can
be done with a Cron Job or the more OS agnostic PgAgent approach. In another
issue, we&#8217;ll cover how to use PgAgent for backup and other scheduling
maintenance tasks such as this.</p>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="index.html">DataONE Generic Member Node 1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010,2011 Participating institutions in DataONE.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>