= HOWTO for itk/d1_client_cli =

This describes how to install and use the DataONE CLI tool.

-- Installation ----------------------------------------------------------------

  There are some modules not available on PyPI (Python Package Indexer).

= Google's foresite library

  Make sure that libxml2-dev and libxslt-dev are installed.

    wget http://foresite-toolkit.googlecode.com/files/foresite-1.2.tgz
    tar xfz foresite-1.2.tgz
    cd foresite-1.2
    sudo python setup.py install


-- Configuration ---------------------------------------------------------------

There are several values that are important to configure in order to make the tool useful.

- Identity

  In order to make the most use of DataONE, you must first
establish an identity within the system.  To configure the tool
to use this.  For help getting an identity, please look at:
http://mule1.dataone.org/ArchitectureDocs-current/design/Authentication.html.


= To set your identity bring up the cli:

  % dataone.py
  DataONE Command Line Interface
  > show
        cli:
          pretty                        True
          verbose                       False
        node:
          dataone-url                   https://cn.dataone.org/cn
          mn-url                        https://localhost/mn/
        slice:
          count                         1000
          start                         0
        auth:
          anonymous                     True
          cert-file                     None
          key-file                      None
        sysmeta:
          algorithm                     SHA-1
          authoritative-mn              None
          object-format                 None
          origin-mn                     None
          rights-holder                 None
          submitter                     None
        search:
          from-date                     None
          query                         *:*
          query-type                    solr
          search-object-format          None
          to-date                       None
        access:
          submitter                     full access
        replication:
          no preferred member nodes
          no blocked member nodes
          number of replicas: 0
          replication allowed: False


= Specify your certificate and key file:

  > set cert-file /tmp/x509up_u501
  > set key-file /tmp/x509up_u501


= Specify your identity:

  > set anonymous False
  > set submitter "CN=Joe Scientist Z999,O=Google,C=US,DC=cilogon,DC=org"

    Although there are conflicting rules about the order of the subject,
    please follow the above order (CN first).


= Save your configuration:

  > save

    By default, it will save the configuration file in ${HOME}/.d1client.conf



= Other useful settings

* Replicas & public access

  By default, no replicas will be created for the new data objects and no
additional access rights will be set up.  This may not be what is desired.

= Change number of replicas and allow the public to view the data

  % dataone.py
  DataONE Command Line Interface
  > allowreplication
        Changed number of replicas to 3.
  > allowpublic
  > set rights-holder "CN=Jane Scientist Z998,O=Google,C=US,DC=cilogon,DC=org"
  > show
        cli:
          pretty                        True
          verbose                       False
        node:
          dataone-url                   https://cn.dataone.org/cn
          mn-url                        https://localhost/mn/
        slice:
          count                         1000
          start                         0
        auth:
          anonymous                     True
          cert-file                     /tmp/x509up_u501
          key-file                      /tmp/x509up_u501
        sysmeta:
          algorithm                     SHA-1
          authoritative-mn              
          object-format                 
          origin-mn                     
          rights-holder                 CN=Jane Scientist Z998,O=Google,C=US,DC=cilogon,DC=org
          submitter                     CN=Joe Scientist Z999,O=Google,C=US,DC=cilogon,DC=org
        search:
          from-date                     None
          query                         *:*
          query-type                    solr
          search-object-format          None
          to-date                       None
        access:
          submitter                     full access
          public                        read
        replication:
          no preferred member nodes
          no blocked member nodes
          number of replicas: 3
          replication allowed: True
  > save


= Search

 Look for everything to do with an ocean:

 % dataone.py search ocean


= Add a spreadsheet of water temperatures

 % dataone.py --object-format=text/csv create janesci.watertemps.20111225 ~/watertemps.csv

 % dataone.py search ocean
